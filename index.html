<!DOCTYPE html>
<html>
<head>
<title>Login</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body { font-family:Arial; background:#111; color:white; text-align:center; padding-top:80px; }
  .btn { padding:12px 20px; background:#ff4500; color:white; border-radius:8px; cursor:pointer; }
</style>
</head>
<body>

<h1>FireZone Login</h1>
<p>Login with Google to continue</p>
<button class="btn" onclick="googleLogin()">Sign in with Google</button>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyD66aIVOTVco6rTtpVinkl64UZGnZDgn1o",
    authDomain: "firezone-elite.firebaseapp.com",
    databaseURL: "https://firezone-elite-default-rtdb.firebaseio.com/",
    projectId: "firezone-elite",
    storageBucket: "firezone-elite.appspot.com",
    messagingSenderId: "121224317328",
    appId: "1:121224317328:web:a4d19bab51fc8076400b15"
  };
  firebase.initializeApp(firebaseConfig);

  const auth = firebase.auth();
  const db = firebase.database();

  function googleLogin() {
    const provider = new firebase.auth.GoogleAuthProvider();

    auth.signInWithPopup(provider)
      .then(result => {
        const user = result.user;

        db.ref("users/" + user.uid).once("value", snap => {
          if (!snap.exists()) {
            db.ref("users/" + user.uid).set({
              email: user.email,
              role: "player"
            });
          }

          let role = snap.val()?.role || "player";

          if (role === "admin") {
            window.location.href = "https://mhsuraj.github.io/firezone-admin/";
          } else {
            window.location.href = "https://mhsuraj.github.io/firezone-public/";
          }
        });
      })
      .catch(err => alert("Error: " + err.message));
  }
</script>

</body>
</html>
